# P1.3 Project Structure Implementation Plan

## 1. Overview and Objectives

### 1.1 Purpose
This document provides detailed step-by-step instructions for establishing the project directory structure, service layer, repository layer, base controllers, Blade layouts, and routing structure for The Strengths Toolbox website.

### 1.2 Scope
This implementation plan covers tasks P1.3.1 through P1.3.6:
- **P1.3.1**: Create directory structure
- **P1.3.2**: Set up service layer structure
- **P1.3.3**: Set up repository structure
- **P1.3.4**: Create base controller classes
- **P1.3.5**: Set up Blade layout structure
- **P1.3.6**: Configure routing structure

### 1.3 Success Criteria
- Complete directory structure created following Laravel and DDD conventions
- Service layer structure established with base classes
- Repository layer structure established
- Base controller classes created
- Blade layout structure set up
- Routing structure configured and organized

## 2. Prerequisites

### 2.1 Required Knowledge
- Laravel directory structure
- Service layer pattern
- Repository pattern
- MVC architecture
- Blade templating
- Laravel routing

### 2.2 Dependencies
- Task P1.1.1 completed (Laravel installed)
- Task P1.1.3 completed (Project structure initialized)
- Task P1.2.3 completed (Models created)

### 2.3 Reference Documents
- Laravel MVC Architecture: `documentation/01-architecture/02-laravel-mvc-architecture.md`
- System Architecture Overview: `documentation/01-architecture/01-system-architecture-overview.md`
- Frontend Architecture: `documentation/01-architecture/04-frontend-architecture.md`

## 3. Task P1.3.1: Create Directory Structure

### 3.1 Overview
Create the complete directory structure following Laravel conventions and Clean Architecture principles.

### 3.2 Step-by-Step Implementation

#### Step 1: Create Service Directory
```bash
mkdir -p app/Services
```

#### Step 2: Create Repository Directory
```bash
mkdir -p app/Repositories
```

#### Step 3: Create Controller Subdirectories
```bash
mkdir -p app/Http/Controllers/Web
mkdir -p app/Http/Controllers/Admin
mkdir -p app/Http/Controllers/Api
```

#### Step 4: Create Request Directory
```bash
mkdir -p app/Http/Requests
```

#### Step 5: Create Middleware Directory (if not exists)
```bash
mkdir -p app/Http/Middleware
```

#### Step 6: Create View Directories
```bash
mkdir -p resources/views/layouts
mkdir -p resources/views/components
mkdir -p resources/views/pages
mkdir -p resources/views/blog
mkdir -p resources/views/admin
mkdir -p resources/views/partials
```

#### Step 7: Create Route Files
```bash
touch routes/admin.php
touch routes/api.php
```

### 3.3 Directory Structure Overview

```
app/
├── Console/
│   └── Commands/
├── Exceptions/
│   └── Handler.php
├── Http/
│   ├── Controllers/
│   │   ├── Admin/          # Admin panel controllers
│   │   ├── Api/             # API controllers
│   │   └── Web/             # Web controllers
│   ├── Middleware/
│   ├── Requests/            # Form request validation
│   └── Kernel.php
├── Models/                  # Eloquent models
├── Repositories/            # Repository layer
├── Services/                # Service layer
└── Providers/

resources/
├── views/
│   ├── layouts/            # Main layouts
│   ├── components/         # Reusable components
│   ├── pages/              # Page views
│   ├── blog/               # Blog views
│   ├── admin/              # Admin views
│   └── partials/          # Partial views
├── css/
│   └── app.css
└── js/
    └── app.js

routes/
├── web.php                  # Web routes
├── admin.php                # Admin routes
└── api.php                  # API routes
```

### 3.4 Validation
```bash
# Verify directory structure
tree -L 3 app/ resources/views/ routes/
```

## 4. Task P1.3.2: Set up Service Layer Structure

### 4.1 Overview
Create the service layer structure with base service class and initial service classes following Clean Architecture principles.

### 4.2 Step-by-Step Implementation

#### Step 1: Create Base Service Class

**File: `app/Services/BaseService.php`**
```php
<?php

namespace App\Services;

abstract class BaseService
{
    /**
     * Handle service errors
     */
    protected function handleError(\Exception $e, string $message = null): void
    {
        \Log::error($message ?? $e->getMessage(), [
            'exception' => $e,
            'service' => static::class,
        ]);

        throw new \RuntimeException($message ?? 'An error occurred in the service layer', 0, $e);
    }

    /**
     * Validate required data
     */
    protected function validateRequired(array $data, array $required): void
    {
        $missing = array_diff($required, array_keys($data));

        if (!empty($missing)) {
            throw new \InvalidArgumentException(
                'Missing required fields: ' . implode(', ', $missing)
            );
        }
    }
}
```

#### Step 2: Create PageService Structure

**File: `app/Services/PageService.php`**
```php
<?php

namespace App\Services;

use App\Models\Page;
use App\Repositories\PageRepository;
use Illuminate\Support\Facades\Cache;

class PageService extends BaseService
{
    protected PageRepository $pageRepository;

    public function __construct(PageRepository $pageRepository)
    {
        $this->pageRepository = $pageRepository;
    }

    /**
     * Get page by slug
     */
    public function getBySlug(string $slug): ?Page
    {
        return Cache::remember("page.{$slug}", 3600, function () use ($slug) {
            return $this->pageRepository->findBySlug($slug);
        });
    }

    /**
     * Get all published pages
     */
    public function getPublishedPages(): \Illuminate\Support\Collection
    {
        return Cache::remember('pages.published', 3600, function () {
            return $this->pageRepository->getPublished();
        });
    }

    /**
     * Create a new page
     */
    public function createPage(array $data): Page
    {
        $this->validateRequired($data, ['title', 'slug', 'content']);

        $page = $this->pageRepository->create($data);

        Cache::forget('pages.published');
        Cache::forget("page.{$page->slug}");

        return $page;
    }

    /**
     * Update a page
     */
    public function updatePage(Page $page, array $data): Page
    {
        $this->pageRepository->update($page, $data);

        Cache::forget('pages.published');
        Cache::forget("page.{$page->slug}");

        return $page->fresh();
    }

    /**
     * Delete a page
     */
    public function deletePage(Page $page): bool
    {
        $slug = $page->slug;
        $result = $this->pageRepository->delete($page);

        Cache::forget('pages.published');
        Cache::forget("page.{$slug}");

        return $result;
    }
}
```

#### Step 3: Create BlogPostService Structure

**File: `app/Services/BlogPostService.php`**
```php
<?php

namespace App\Services;

use App\Models\BlogPost;
use App\Repositories\BlogPostRepository;
use Illuminate\Support\Facades\Cache;

class BlogPostService extends BaseService
{
    protected BlogPostRepository $blogPostRepository;

    public function __construct(BlogPostRepository $blogPostRepository)
    {
        $this->blogPostRepository = $blogPostRepository;
    }

    /**
     * Get published blog posts
     */
    public function getPublishedPosts(int $perPage = 10): \Illuminate\Contracts\Pagination\LengthAwarePaginator
    {
        return $this->blogPostRepository->getPublishedPaginated($perPage);
    }

    /**
     * Get blog post by slug
     */
    public function getBySlug(string $slug): ?BlogPost
    {
        return Cache::remember("blog.{$slug}", 3600, function () use ($slug) {
            return $this->blogPostRepository->findBySlug($slug);
        });
    }

    /**
     * Create a new blog post
     */
    public function createPost(array $data): BlogPost
    {
        $this->validateRequired($data, ['title', 'slug', 'content', 'author_id']);

        $post = $this->blogPostRepository->create($data);

        Cache::forget('blog.published');

        return $post;
    }
}
```

#### Step 4: Create FormService Structure

**File: `app/Services/FormService.php`**
```php
<?php

namespace App\Services;

use App\Models\Form;
use App\Models\FormSubmission;
use App\Repositories\FormRepository;
use Illuminate\Support\Facades\Mail;

class FormService extends BaseService
{
    protected FormRepository $formRepository;

    public function __construct(FormRepository $formRepository)
    {
        $this->formRepository = $formRepository;
    }

    /**
     * Get form by slug
     */
    public function getBySlug(string $slug): ?Form
    {
        return $this->formRepository->findBySlug($slug);
    }

    /**
     * Submit form
     */
    public function submitForm(Form $form, array $data): FormSubmission
    {
        $submission = $this->formRepository->createSubmission($form, [
            'data' => $data,
            'ip_address' => request()->ip(),
            'user_agent' => request()->userAgent(),
        ]);

        // Send email notification (to be implemented in Phase 2)
        // $this->sendFormNotification($form, $submission);

        return $submission;
    }
}
```

### 4.3 Validation
```bash
# Test service instantiation
php artisan tinker

# In tinker:
$pageService = app(\App\Services\PageService::class);
# Should not throw errors
```

## 5. Task P1.3.3: Set up Repository Structure

### 5.1 Overview
Create the repository layer structure with base repository and specific repositories for data access abstraction.

### 5.2 Step-by-Step Implementation

#### Step 1: Create Base Repository Interface

**File: `app/Repositories/BaseRepositoryInterface.php`**
```php
<?php

namespace App\Repositories;

interface BaseRepositoryInterface
{
    public function find(int $id);

    public function create(array $data);

    public function update($model, array $data);

    public function delete($model): bool;

    public function all();
}
```

#### Step 2: Create Base Repository

**File: `app/Repositories/BaseRepository.php`**
```php
<?php

namespace App\Repositories;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Support\Collection;

abstract class BaseRepository implements BaseRepositoryInterface
{
    protected Model $model;

    public function __construct(Model $model)
    {
        $this->model = $model;
    }

    public function find(int $id)
    {
        return $this->model->find($id);
    }

    public function create(array $data)
    {
        return $this->model->create($data);
    }

    public function update($model, array $data)
    {
        $model->update($data);
        return $model->fresh();
    }

    public function delete($model): bool
    {
        return $model->delete();
    }

    public function all(): Collection
    {
        return $this->model->all();
    }
}
```

#### Step 3: Create PageRepository

**File: `app/Repositories/PageRepository.php`**
```php
<?php

namespace App\Repositories;

use App\Models\Page;
use Illuminate\Support\Collection;

class PageRepository extends BaseRepository
{
    public function __construct(Page $model)
    {
        parent::__construct($model);
    }

    /**
     * Find page by slug
     */
    public function findBySlug(string $slug): ?Page
    {
        return $this->model
            ->where('slug', $slug)
            ->where('is_published', true)
            ->first();
    }

    /**
     * Get all published pages
     */
    public function getPublished(): Collection
    {
        return $this->model
            ->published()
            ->orderBy('published_at', 'desc')
            ->get();
    }

    /**
     * Get page by slug (including unpublished)
     */
    public function findBySlugAny(string $slug): ?Page
    {
        return $this->model->where('slug', $slug)->first();
    }
}
```

#### Step 4: Create BlogPostRepository

**File: `app/Repositories/BlogPostRepository.php`**
```php
<?php

namespace App\Repositories;

use App\Models\BlogPost;
use Illuminate\Contracts\Pagination\LengthAwarePaginator;
use Illuminate\Support\Collection;

class BlogPostRepository extends BaseRepository
{
    public function __construct(BlogPost $model)
    {
        parent::__construct($model);
    }

    /**
     * Find blog post by slug
     */
    public function findBySlug(string $slug): ?BlogPost
    {
        return $this->model
            ->published()
            ->where('slug', $slug)
            ->with(['author', 'categories', 'tags'])
            ->first();
    }

    /**
     * Get published posts paginated
     */
    public function getPublishedPaginated(int $perPage = 10): LengthAwarePaginator
    {
        return $this->model
            ->published()
            ->with(['author', 'categories'])
            ->orderBy('published_at', 'desc')
            ->paginate($perPage);
    }

    /**
     * Get posts by category
     */
    public function getByCategory(int $categoryId, int $perPage = 10): LengthAwarePaginator
    {
        return $this->model
            ->published()
            ->whereHas('categories', function ($query) use ($categoryId) {
                $query->where('categories.id', $categoryId);
            })
            ->with(['author', 'categories'])
            ->orderBy('published_at', 'desc')
            ->paginate($perPage);
    }
}
```

#### Step 5: Create FormRepository

**File: `app/Repositories/FormRepository.php`**
```php
<?php

namespace App\Repositories;

use App\Models\Form;
use App\Models\FormSubmission;

class FormRepository extends BaseRepository
{
    public function __construct(Form $model)
    {
        parent::__construct($model);
    }

    /**
     * Find form by slug
     */
    public function findBySlug(string $slug): ?Form
    {
        return $this->model
            ->where('slug', $slug)
            ->where('is_active', true)
            ->first();
    }

    /**
     * Create form submission
     */
    public function createSubmission(Form $form, array $data): FormSubmission
    {
        return $form->submissions()->create($data);
    }

    /**
     * Get form submissions
     */
    public function getSubmissions(Form $form, int $perPage = 15)
    {
        return $form->submissions()
            ->orderBy('created_at', 'desc')
            ->paginate($perPage);
    }
}
```

### 5.3 Register Repositories in Service Provider

**File: `app/Providers/RepositoryServiceProvider.php`** (create if needed)
```php
<?php

namespace App\Providers;

use App\Models\Page;
use App\Models\BlogPost;
use App\Models\Form;
use App\Repositories\PageRepository;
use App\Repositories\BlogPostRepository;
use App\Repositories\FormRepository;
use Illuminate\Support\ServiceProvider;

class RepositoryServiceProvider extends ServiceProvider
{
    public function register(): void
    {
        $this->app->singleton(PageRepository::class, function ($app) {
            return new PageRepository(new Page());
        });

        $this->app->singleton(BlogPostRepository::class, function ($app) {
            return new BlogPostRepository(new BlogPost());
        });

        $this->app->singleton(FormRepository::class, function ($app) {
            return new FormRepository(new Form());
        });
    }

    public function boot(): void
    {
        //
    }
}
```

**File: `config/app.php`** (register provider)
```php
'providers' => [
    // ... other providers
    App\Providers\RepositoryServiceProvider::class,
],
```

### 5.4 Validation
```bash
# Test repository instantiation
php artisan tinker

# In tinker:
$pageRepo = app(\App\Repositories\PageRepository::class);
$pageRepo->all(); // Should return collection
```

## 6. Task P1.3.4: Create Base Controller Classes

### 6.1 Overview
Create base controller classes for Web, Admin, and API controllers with common functionality.

### 6.2 Step-by-Step Implementation

#### Step 1: Create Base Web Controller

**File: `app/Http/Controllers/Web/BaseController.php`**
```php
<?php

namespace App\Http\Controllers\Web;

use App\Http\Controllers\Controller;
use Illuminate\Http\Request;

abstract class BaseController extends Controller
{
    /**
     * Return JSON response for API-like requests
     */
    protected function jsonResponse(array $data, int $status = 200)
    {
        return response()->json($data, $status);
    }

    /**
     * Return error response
     */
    protected function errorResponse(string $message, int $status = 400)
    {
        return response()->json([
            'error' => $message,
        ], $status);
    }

    /**
     * Return success response
     */
    protected function successResponse(array $data = [], string $message = null)
    {
        $response = ['success' => true];

        if ($message) {
            $response['message'] = $message;
        }

        if (!empty($data)) {
            $response['data'] = $data;
        }

        return response()->json($response);
    }
}
```

#### Step 2: Create Base Admin Controller

**File: `app/Http/Controllers/Admin/BaseController.php`**
```php
<?php

namespace App\Http\Controllers\Admin;

use App\Http\Controllers\Controller;
use Illuminate\Http\Request;

abstract class BaseController extends Controller
{
    /**
     * Return view with admin layout
     */
    protected function adminView(string $view, array $data = [])
    {
        return view($view, $data);
    }

    /**
     * Return success redirect with message
     */
    protected function successRedirect(string $route, string $message)
    {
        return redirect()->route($route)->with('success', $message);
    }

    /**
     * Return error redirect with message
     */
    protected function errorRedirect(string $route, string $message)
    {
        return redirect()->route($route)->with('error', $message);
    }

    /**
     * Return back with success message
     */
    protected function backWithSuccess(string $message)
    {
        return back()->with('success', $message);
    }

    /**
     * Return back with error message
     */
    protected function backWithError(string $message)
    {
        return back()->with('error', $message);
    }
}
```

#### Step 3: Create Base API Controller

**File: `app/Http/Controllers/Api/BaseController.php`**
```php
<?php

namespace App\Http\Controllers\Api;

use App\Http\Controllers\Controller;
use Illuminate\Http\Request;

abstract class BaseController extends Controller
{
    /**
     * Return success JSON response
     */
    protected function success(array $data = [], string $message = null, int $status = 200)
    {
        $response = [
            'success' => true,
        ];

        if ($message) {
            $response['message'] = $message;
        }

        if (!empty($data)) {
            $response['data'] = $data;
        }

        return response()->json($response, $status);
    }

    /**
     * Return error JSON response
     */
    protected function error(string $message, int $status = 400, array $errors = [])
    {
        $response = [
            'success' => false,
            'message' => $message,
        ];

        if (!empty($errors)) {
            $response['errors'] = $errors;
        }

        return response()->json($response, $status);
    }

    /**
     * Return validation error response
     */
    protected function validationError(array $errors)
    {
        return $this->error('Validation failed', 422, $errors);
    }
}
```

#### Step 4: Create HomeController

**File: `app/Http/Controllers/Web/HomeController.php`**
```php
<?php

namespace App\Http\Controllers\Web;

use App\Services\PageService;
use Illuminate\Http\Request;

class HomeController extends BaseController
{
    protected PageService $pageService;

    public function __construct(PageService $pageService)
    {
        $this->pageService = $pageService;
    }

    /**
     * Display homepage
     */
    public function index()
    {
        $page = $this->pageService->getBySlug('home');

        if (!$page) {
            abort(404);
        }

        return view('pages.home', compact('page'));
    }
}
```

#### Step 5: Create PageController

**File: `app/Http/Controllers/Web/PageController.php`**
```php
<?php

namespace App\Http\Controllers\Web;

use App\Services\PageService;
use Illuminate\Http\Request;

class PageController extends BaseController
{
    protected PageService $pageService;

    public function __construct(PageService $pageService)
    {
        $this->pageService = $pageService;
    }

    /**
     * Display a page by slug
     */
    public function show(string $slug)
    {
        $page = $this->pageService->getBySlug($slug);

        if (!$page) {
            abort(404);
        }

        return view('pages.show', compact('page'));
    }
}
```

### 6.3 Validation
```bash
# Test controller instantiation
php artisan tinker

# In tinker:
$controller = app(\App\Http\Controllers\Web\HomeController::class);
# Should not throw errors
```

## 7. Task P1.3.5: Set up Blade Layout Structure

### 7.1 Overview
Create the Blade layout structure with main app layout, admin layout, and reusable components.

### 7.2 Step-by-Step Implementation

#### Step 1: Create Main App Layout

**File: `resources/views/layouts/app.blade.php`**
```blade
<!DOCTYPE html>
<html lang="{{ str_replace('_', '-', app()->getLocale()) }}">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="csrf-token" content="{{ csrf_token() }}">
    
    <title>@yield('title', config('app.name'))</title>
    
    @include('partials.meta')
    
    @vite(['resources/css/app.css', 'resources/js/app.js'])
    
    @stack('styles')
</head>
<body class="font-sans antialiased">
    <div id="app">
        @include('components.header')
        
        <main>
            @yield('content')
        </main>
        
        @include('components.footer')
    </div>
    
    @stack('scripts')
</body>
</html>
```

#### Step 2: Create Admin Layout

**File: `resources/views/layouts/admin.blade.php`**
```blade
<!DOCTYPE html>
<html lang="{{ str_replace('_', '-', app()->getLocale()) }}">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="csrf-token" content="{{ csrf_token() }}">
    
    <title>@yield('title', 'Admin - ' . config('app.name'))</title>
    
    @vite(['resources/css/app.css', 'resources/js/app.js'])
    
    @stack('styles')
</head>
<body class="font-sans antialiased bg-gray-100">
    <div class="min-h-screen">
        @include('admin.partials.sidebar')
        
        <div class="ml-64">
            @include('admin.partials.header')
            
            <main class="p-6">
                @if(session('success'))
                    <div class="mb-4 p-4 bg-green-100 border border-green-400 text-green-700 rounded">
                        {{ session('success') }}
                    </div>
                @endif
                
                @if(session('error'))
                    <div class="mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded">
                        {{ session('error') }}
                    </div>
                @endif
                
                @yield('content')
            </main>
        </div>
    </div>
    
    @stack('scripts')
</body>
</html>
```

#### Step 3: Create Meta Partial

**File: `resources/views/partials/meta.blade.php`**
```blade
@if(isset($page))
    <meta name="description" content="{{ $page->meta_description ?? $page->excerpt }}">
    <meta name="keywords" content="{{ $page->meta_keywords ?? '' }}">
    
    @if($page->seo)
        <meta property="og:title" content="{{ $page->seo->og_title ?? $page->meta_title ?? $page->title }}">
        <meta property="og:description" content="{{ $page->seo->og_description ?? $page->meta_description }}">
        <meta property="og:image" content="{{ $page->seo->og_image ?? '' }}">
        <meta property="og:type" content="website">
        <meta property="og:url" content="{{ url()->current() }}">
        
        <meta name="twitter:card" content="{{ $page->seo->twitter_card ?? 'summary' }}">
        <meta name="twitter:title" content="{{ $page->seo->og_title ?? $page->title }}">
        <meta name="twitter:description" content="{{ $page->seo->og_description ?? $page->meta_description }}">
    @endif
@else
    <meta name="description" content="{{ config('app.name') }}">
@endif
```

#### Step 4: Create Header Component

**File: `resources/views/components/header.blade.php`**
```blade
<header class="bg-white shadow-sm">
    <nav class="container-custom">
        <div class="flex items-center justify-between h-16">
            <div class="flex items-center">
                <a href="{{ route('home') }}" class="text-xl font-bold text-primary-600">
                    {{ config('app.name') }}
                </a>
            </div>
            
            <div class="hidden md:flex items-center space-x-8">
                <a href="{{ route('home') }}" class="text-gray-700 hover:text-primary-600">Home</a>
                <a href="{{ route('blog.index') }}" class="text-gray-700 hover:text-primary-600">Blog</a>
                <a href="{{ route('contact') }}" class="text-gray-700 hover:text-primary-600">Contact</a>
            </div>
        </div>
    </nav>
</header>
```

#### Step 5: Create Footer Component

**File: `resources/views/components/footer.blade.php`**
```blade
<footer class="bg-gray-800 text-white mt-auto">
    <div class="container-custom section-padding">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <div>
                <h3 class="text-lg font-bold mb-4">{{ config('app.name') }}</h3>
                <p class="text-gray-400">Build Strong Teams. Unlock Strong Profits.</p>
            </div>
            
            <div>
                <h4 class="text-lg font-semibold mb-4">Quick Links</h4>
                <ul class="space-y-2">
                    <li><a href="{{ route('home') }}" class="text-gray-400 hover:text-white">Home</a></li>
                    <li><a href="{{ route('blog.index') }}" class="text-gray-400 hover:text-white">Blog</a></li>
                    <li><a href="{{ route('contact') }}" class="text-gray-400 hover:text-white">Contact</a></li>
                </ul>
            </div>
            
            <div>
                <h4 class="text-lg font-semibold mb-4">Contact</h4>
                <p class="text-gray-400">info@thestrengthstoolbox.com</p>
            </div>
        </div>
        
        <div class="mt-8 pt-8 border-t border-gray-700 text-center text-gray-400">
            <p>&copy; {{ date('Y') }} {{ config('app.name') }}. All rights reserved.</p>
        </div>
    </div>
</footer>
```

#### Step 6: Create Sample Page View

**File: `resources/views/pages/home.blade.php`**
```blade
@extends('layouts.app')

@section('title', $page->meta_title ?? $page->title)

@section('content')
<div class="container-custom section-padding">
    <article>
        <h1 class="text-4xl font-bold mb-6">{{ $page->title }}</h1>
        
        <div class="prose max-w-none">
            {!! $page->content !!}
        </div>
    </article>
</div>
@endsection
```

#### Step 7: Create Page Show View

**File: `resources/views/pages/show.blade.php`**
```blade
@extends('layouts.app')

@section('title', $page->meta_title ?? $page->title)

@section('content')
<div class="container-custom section-padding">
    <article>
        <h1 class="text-4xl font-bold mb-6">{{ $page->title }}</h1>
        
        @if($page->excerpt)
            <p class="text-xl text-gray-600 mb-6">{{ $page->excerpt }}</p>
        @endif
        
        <div class="prose max-w-none">
            {!! $page->content !!}
        </div>
    </article>
</div>
@endsection
```

### 7.3 Validation
```bash
# Test view rendering
php artisan serve

# Visit http://localhost:8000
# Should see homepage without errors
```

## 8. Task P1.3.6: Configure Routing Structure

### 8.1 Overview
Configure the routing structure with separate route files for web, admin, and API routes.

### 8.2 Step-by-Step Implementation

#### Step 1: Update RouteServiceProvider

**File: `app/Providers/RouteServiceProvider.php`**
```php
<?php

namespace App\Providers;

use Illuminate\Cache\RateLimiting\Limit;
use Illuminate\Foundation\Support\Providers\RouteServiceProvider as ServiceProvider;
use Illuminate\Http\Request;
use Illuminate\Support\Facades\RateLimiter;
use Illuminate\Support\Facades\Route;

class RouteServiceProvider extends ServiceProvider
{
    public const HOME = '/';

    public function boot(): void
    {
        RateLimiter::for('api', function (Request $request) {
            return Limit::perMinute(60)->by($request->user()?->id ?: $request->ip());
        });

        $this->routes(function () {
            Route::middleware('web')
                ->group(base_path('routes/web.php'));

            Route::prefix('admin')
                ->middleware(['web', 'auth:admin'])
                ->name('admin.')
                ->group(base_path('routes/admin.php'));

            Route::prefix('api')
                ->middleware('api')
                ->group(base_path('routes/api.php'));
        });
    }
}
```

#### Step 2: Configure Web Routes

**File: `routes/web.php`**
```php
<?php

use App\Http\Controllers\Web\HomeController;
use App\Http\Controllers\Web\PageController;
use Illuminate\Support\Facades\Route;

// Homepage
Route::get('/', [HomeController::class, 'index'])->name('home');

// Static pages
Route::get('/about-us', [PageController::class, 'show'])->name('about');
Route::get('/contact', function () {
    return view('pages.contact');
})->name('contact');

// Dynamic pages (catch-all for CMS pages - must be last)
Route::get('/{slug}', [PageController::class, 'show'])->name('page.show');
```

#### Step 3: Configure Admin Routes

**File: `routes/admin.php`**
```php
<?php

use App\Http\Controllers\Admin\AdminDashboardController;
use Illuminate\Support\Facades\Route;

Route::get('/', [AdminDashboardController::class, 'index'])->name('dashboard');

// Additional admin routes will be added in Phase 2
```

#### Step 4: Create AdminDashboardController

**File: `app/Http/Controllers/Admin/AdminDashboardController.php`**
```php
<?php

namespace App\Http\Controllers\Admin;

use Illuminate\Http\Request;

class AdminDashboardController extends BaseController
{
    public function index()
    {
        return view('admin.dashboard');
    }
}
```

#### Step 5: Create Admin Dashboard View

**File: `resources/views/admin/dashboard.blade.php`**
```blade
@extends('layouts.admin')

@section('title', 'Dashboard')

@section('content')
<div class="bg-white rounded-lg shadow p-6">
    <h1 class="text-2xl font-bold mb-4">Admin Dashboard</h1>
    <p class="text-gray-600">Welcome to the admin panel.</p>
</div>
@endsection
```

#### Step 6: Configure API Routes

**File: `routes/api.php`**
```php
<?php

use Illuminate\Http\Request;
use Illuminate\Support\Facades\Route;

Route::middleware('auth:sanctum')->get('/user', function (Request $request) {
    return $request->user();
});

// API routes will be added in Phase 2
```

### 8.3 Validation
```bash
# List all routes
php artisan route:list

# Test routes
php artisan serve

# Visit:
# - http://localhost:8000 (homepage)
# - http://localhost:8000/about-us (page)
# - http://localhost:8000/admin (should redirect to login)
```

## 9. Testing and Validation

### 9.1 Complete Structure Test
```bash
# 1. Verify directory structure
ls -la app/Services/
ls -la app/Repositories/
ls -la app/Http/Controllers/Web/
ls -la resources/views/layouts/

# 2. Verify services work
php artisan tinker
$service = app(\App\Services\PageService::class);

# 3. Verify routes
php artisan route:list

# 4. Test views
php artisan serve
# Visit http://localhost:8000
```

### 9.2 Common Issues and Solutions

#### Issue: Service not found
**Solution**: Ensure services are properly namespaced and autoloaded. Run `composer dump-autoload`.

#### Issue: Repository binding fails
**Solution**: Ensure RepositoryServiceProvider is registered in `config/app.php`.

#### Issue: View not found
**Solution**: Check view path matches file location. Clear view cache: `php artisan view:clear`.

#### Issue: Route not found
**Solution**: Verify RouteServiceProvider is loading route files. Clear route cache: `php artisan route:clear`.

## 10. References

### 10.1 Architecture Documents
- Laravel MVC Architecture: `documentation/01-architecture/02-laravel-mvc-architecture.md`
- System Architecture Overview: `documentation/01-architecture/01-system-architecture-overview.md`
- Frontend Architecture: `documentation/01-architecture/04-frontend-architecture.md`

### 10.2 External Resources
- [Laravel Routing](https://laravel.com/docs/10.x/routing)
- [Laravel Views](https://laravel.com/docs/10.x/views)
- [Laravel Service Container](https://laravel.com/docs/10.x/container)

### 10.3 Related Tasks
- **Previous Task**: P1.2 - Database Setup
- **Next Task**: P1.4 - Authentication Implementation Plan
- **Dependencies**: P1.1.1, P1.2.3
- **Dependent Tasks**: P1.4.1, P2.1.1, P2.3.1

---

**Document Version**: 1.0  
**Last Updated**: 2025  
**Status**: Ready for Implementation
