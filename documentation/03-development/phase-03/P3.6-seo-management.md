# P3.6 SEO Management Implementation Plan

## 1. Overview and Objectives

### 1.1 Purpose
This document provides detailed step-by-step instructions for implementing the SEO management tools in the admin panel for The Strengths Toolbox website. This includes building interfaces for managing meta tags, schema markup, Open Graph tags, and Twitter Cards.

### 1.2 Scope
This implementation plan covers tasks P3.6.1 through P3.6.4:
- **P3.6.1**: Build SEO meta tag editor
- **P3.6.2**: Implement schema markup editor
- **P3.6.3**: Add Open Graph tag management
- **P3.6.4**: Build Twitter Card editor

### 1.3 Success Criteria
- SEO meta tag editor functional for pages and blog posts
- Schema markup editor with validation
- Open Graph tag management working
- Twitter Card editor functional
- All SEO data properly integrated with SEOService
- Preview functionality for SEO tags

## 2. Prerequisites

### 2.1 Required Knowledge
- SEO best practices
- Meta tags and Open Graph protocol
- Schema.org structured data
- Twitter Card specifications
- JSON-LD format

### 2.2 Dependencies
- Task P2.1.4 completed (SEOService created)
- Task P1.2.3 completed (PageSEO model created)
- Task P3.1 completed (Page management)
- Task P3.2 completed (Blog management)

### 2.3 Reference Documents
- SEO Architecture: `documentation/01-architecture/05-seo-architecture.md`
- Admin Panel Architecture: `documentation/01-architecture/09-admin-panel-architecture.md`
- SEOService: `app/Services/SEOService.php`

## 3. Existing Implementation Review

### 3.1 Current State
The following components are already implemented:
- `SEOService` with methods for generating meta data
- `PageSEO` model for storing SEO data
- Basic meta tags in page and blog post forms
- Schema markup generation in SEOService

### 3.2 What Needs to Be Built
- Comprehensive SEO management interface
- Schema markup editor with validation
- Open Graph and Twitter Card editors
- SEO preview functionality
- Bulk SEO management tools

## 4. Task P3.6.1: Build SEO Meta Tag Editor

### 4.1 Overview
Create a comprehensive interface for editing SEO meta tags for pages and blog posts.

### 4.2 Step-by-Step Implementation

#### Step 1: Create SEO Controller

**File: `app/Http/Controllers/Admin/AdminSEOController.php`**

```php
<?php

namespace App\Http\Controllers\Admin;

use App\Http\Controllers\Controller;
use App\Models\Page;
use App\Models\BlogPost;
use App\Services\SEOService;
use Illuminate\Http\Request;

class AdminSEOController extends Controller
{
    protected SEOService $seoService;

    public function __construct(SEOService $seoService)
    {
        $this->seoService = $seoService;
    }

    /**
     * Display SEO management dashboard
     *
     * @return \Illuminate\View\View
     */
    public function index()
    {
        $pagesWithoutSEO = Page::whereDoesntHave('seo')
            ->orWhereHas('seo', function($query) {
                $query->whereNull('og_title')
                      ->orWhereNull('og_description');
            })
            ->count();

        $postsWithoutSEO = BlogPost::whereNull('meta_title')
            ->orWhereNull('meta_description')
            ->count();

        return view('admin.seo.index', compact('pagesWithoutSEO', 'postsWithoutSEO'));
    }

    /**
     * Show SEO editor for a page
     *
     * @param Page $page
     * @return \Illuminate\View\View
     */
    public function editPage(Page $page)
    {
        $seo = $page->seo;
        $currentMeta = $this->seoService->getPageMeta($page);

        return view('admin.seo.edit-page', compact('page', 'seo', 'currentMeta'));
    }

    /**
     * Update SEO for a page
     *
     * @param Request $request
     * @param Page $page
     * @return \Illuminate\Http\RedirectResponse
     */
    public function updatePage(Request $request, Page $page)
    {
        $validated = $request->validate([
            'meta_title' => 'nullable|string|max:255',
            'meta_description' => 'nullable|string|max:500',
            'meta_keywords' => 'nullable|string|max:255',
            'og_title' => 'nullable|string|max:255',
            'og_description' => 'nullable|string|max:500',
            'og_image' => 'nullable|url|max:500',
            'og_type' => 'nullable|string|in:website,article',
            'twitter_card' => 'nullable|string|in:summary,summary_large_image',
            'twitter_title' => 'nullable|string|max:255',
            'twitter_description' => 'nullable|string|max:500',
            'twitter_image' => 'nullable|url|max:500',
            'canonical_url' => 'nullable|url|max:500',
        ]);

        // Update page meta fields
        $page->update([
            'meta_title' => $validated['meta_title'] ?? $page->meta_title,
            'meta_description' => $validated['meta_description'] ?? $page->meta_description,
            'meta_keywords' => $validated['meta_keywords'] ?? $page->meta_keywords,
        ]);

        // Update or create PageSEO
        $seo = $page->seo ?? $page->seo()->create([]);
        $seo->update([
            'og_title' => $validated['og_title'] ?? null,
            'og_description' => $validated['og_description'] ?? null,
            'og_image' => $validated['og_image'] ?? null,
            'twitter_card' => $validated['twitter_card'] ?? null,
            'canonical_url' => $validated['canonical_url'] ?? null,
        ]);

        // Clear SEO cache
        $this->seoService->clearPageCache($page);

        return redirect()->route('admin.seo.edit-page', $page)
            ->with('success', 'SEO settings updated successfully.');
    }

    /**
     * Show SEO editor for a blog post
     *
     * @param BlogPost $post
     * @return \Illuminate\View\View
     */
    public function editPost(BlogPost $post)
    {
        $currentMeta = $this->seoService->getBlogPostMeta($post);

        return view('admin.seo.edit-post', compact('post', 'currentMeta'));
    }

    /**
     * Update SEO for a blog post
     *
     * @param Request $request
     * @param BlogPost $post
     * @return \Illuminate\Http\RedirectResponse
     */
    public function updatePost(Request $request, BlogPost $post)
    {
        $validated = $request->validate([
            'meta_title' => 'nullable|string|max:255',
            'meta_description' => 'nullable|string|max:500',
            'meta_keywords' => 'nullable|string|max:255',
        ]);

        $post->update($validated);

        // Clear SEO cache
        $this->seoService->clearBlogPostCache($post);

        return redirect()->route('admin.seo.edit-post', $post)
            ->with('success', 'SEO settings updated successfully.');
    }
}
```

#### Step 2: Add Routes

**File: `routes/admin.php`** (add)

```php
Route::prefix('seo')->name('seo.')->group(function () {
    Route::get('/', [AdminSEOController::class, 'index'])->name('index');
    Route::get('/pages/{page}/edit', [AdminSEOController::class, 'editPage'])->name('edit-page');
    Route::put('/pages/{page}', [AdminSEOController::class, 'updatePage'])->name('update-page');
    Route::get('/posts/{post}/edit', [AdminSEOController::class, 'editPost'])->name('edit-post');
    Route::put('/posts/{post}', [AdminSEOController::class, 'updatePost'])->name('update-post');
});
```

#### Step 3: Create SEO Index View

**File: `resources/views/admin/seo/index.blade.php`**

```blade
@extends('layouts.admin')

@section('title', 'SEO Management')

@section('content')
<div class="space-y-6">
    <div>
        <h1 class="text-2xl font-bold text-gray-900">SEO Management</h1>
        <p class="mt-1 text-sm text-gray-600">Manage SEO settings for pages and blog posts</p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="bg-white rounded-lg shadow p-6">
            <h2 class="text-lg font-semibold text-gray-900 mb-4">Pages</h2>
            <div class="space-y-4">
                <div>
                    <p class="text-sm text-gray-600">Pages without complete SEO</p>
                    <p class="text-2xl font-bold text-gray-900">{{ $pagesWithoutSEO }}</p>
                </div>
                <a href="{{ route('admin.pages.index') }}" class="btn btn-outline">
                    Manage Pages
                </a>
            </div>
        </div>

        <div class="bg-white rounded-lg shadow p-6">
            <h2 class="text-lg font-semibold text-gray-900 mb-4">Blog Posts</h2>
            <div class="space-y-4">
                <div>
                    <p class="text-sm text-gray-600">Posts without complete SEO</p>
                    <p class="text-2xl font-bold text-gray-900">{{ $postsWithoutSEO }}</p>
                </div>
                <a href="{{ route('admin.blog.index') }}" class="btn btn-outline">
                    Manage Posts
                </a>
            </div>
        </div>
    </div>
</div>
@endsection
```

#### Step 4: Create Page SEO Editor View

**File: `resources/views/admin/seo/edit-page.blade.php`**

```blade
@extends('layouts.admin')

@section('title', 'Edit SEO - ' . $page->title)

@section('content')
<div class="max-w-4xl mx-auto">
    <div class="mb-6">
        <div class="flex items-center justify-between">
            <div>
                <h1 class="text-2xl font-bold text-gray-900">Edit SEO</h1>
                <p class="mt-1 text-sm text-gray-600">{{ $page->title }}</p>
            </div>
            <a href="{{ route('admin.pages.edit', $page) }}" class="btn btn-outline">
                Edit Page
            </a>
        </div>
    </div>

    <form method="POST" action="{{ route('admin.seo.update-page', $page) }}">
        @csrf
        @method('PUT')

        <div class="space-y-6">
            {{-- Basic Meta Tags --}}
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-lg font-semibold text-gray-900 mb-4">Basic Meta Tags</h2>
                
                <div class="space-y-4">
                    <div>
                        <label for="meta_title" class="form-label">Meta Title</label>
                        <input 
                            type="text" 
                            id="meta_title" 
                            name="meta_title" 
                            value="{{ old('meta_title', $page->meta_title) }}"
                            maxlength="255"
                            class="form-input @error('meta_title') border-red-500 @enderror"
                            placeholder="SEO title (50-60 characters recommended)"
                        >
                        <p class="mt-1 text-sm text-gray-500">
                            <span id="titleCount">{{ strlen(old('meta_title', $page->meta_title ?? '')) }}</span>/255 characters
                            <span id="titleWarning" class="hidden text-yellow-600"> (Recommended: 50-60 characters)</span>
                        </p>
                        @error('meta_title')
                            <p class="form-error">{{ $message }}</p>
                        @enderror
                    </div>

                    <div>
                        <label for="meta_description" class="form-label">Meta Description</label>
                        <textarea 
                            id="meta_description" 
                            name="meta_description" 
                            rows="3"
                            maxlength="500"
                            class="form-input @error('meta_description') border-red-500 @enderror"
                            placeholder="SEO description (150-160 characters recommended)"
                        >{{ old('meta_description', $page->meta_description) }}</textarea>
                        <p class="mt-1 text-sm text-gray-500">
                            <span id="descCount">{{ strlen(old('meta_description', $page->meta_description ?? '')) }}</span>/500 characters
                            <span id="descWarning" class="hidden text-yellow-600"> (Recommended: 150-160 characters)</span>
                        </p>
                        @error('meta_description')
                            <p class="form-error">{{ $message }}</p>
                        @enderror
                    </div>

                    <div>
                        <label for="meta_keywords" class="form-label">Meta Keywords</label>
                        <input 
                            type="text" 
                            id="meta_keywords" 
                            name="meta_keywords" 
                            value="{{ old('meta_keywords', $page->meta_keywords) }}"
                            class="form-input @error('meta_keywords') border-red-500 @enderror"
                            placeholder="keyword1, keyword2, keyword3"
                        >
                        <p class="mt-1 text-sm text-gray-500">Comma-separated keywords (less important for SEO)</p>
                        @error('meta_keywords')
                            <p class="form-error">{{ $message }}</p>
                        @enderror
                    </div>

                    <div>
                        <label for="canonical_url" class="form-label">Canonical URL</label>
                        <input 
                            type="url" 
                            id="canonical_url" 
                            name="canonical_url" 
                            value="{{ old('canonical_url', $seo->canonical_url ?? url('/' . $page->slug)) }}"
                            class="form-input @error('canonical_url') border-red-500 @enderror"
                            placeholder="https://example.com/page"
                        >
                        <p class="mt-1 text-sm text-gray-500">Leave empty to use default URL</p>
                        @error('canonical_url')
                            <p class="form-error">{{ $message }}</p>
                        @enderror
                    </div>
                </div>
            </div>

            {{-- Open Graph Tags --}}
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-lg font-semibold text-gray-900 mb-4">Open Graph Tags</h2>
                
                <div class="space-y-4">
                    <div>
                        <label for="og_title" class="form-label">OG Title</label>
                        <input 
                            type="text" 
                            id="og_title" 
                            name="og_title" 
                            value="{{ old('og_title', $seo->og_title ?? $page->meta_title ?? $page->title) }}"
                            maxlength="255"
                            class="form-input @error('og_title') border-red-500 @enderror"
                        >
                        @error('og_title')
                            <p class="form-error">{{ $message }}</p>
                        @enderror
                    </div>

                    <div>
                        <label for="og_description" class="form-label">OG Description</label>
                        <textarea 
                            id="og_description" 
                            name="og_description" 
                            rows="3"
                            maxlength="500"
                            class="form-input @error('og_description') border-red-500 @enderror"
                        >{{ old('og_description', $seo->og_description ?? $page->meta_description) }}</textarea>
                        @error('og_description')
                            <p class="form-error">{{ $message }}</p>
                        @enderror
                    </div>

                    <div>
                        <label for="og_image" class="form-label">OG Image URL</label>
                        <input 
                            type="url" 
                            id="og_image" 
                            name="og_image" 
                            value="{{ old('og_image', $seo->og_image) }}"
                            class="form-input @error('og_image') border-red-500 @enderror"
                            placeholder="https://example.com/image.jpg"
                        >
                        <p class="mt-1 text-sm text-gray-500">Recommended: 1200x630px</p>
                        @error('og_image')
                            <p class="form-error">{{ $message }}</p>
                        @enderror
                    </div>

                    <div>
                        <label for="og_type" class="form-label">OG Type</label>
                        <select 
                            id="og_type" 
                            name="og_type" 
                            class="form-input @error('og_type') border-red-500 @enderror"
                        >
                            <option value="website" {{ old('og_type', $seo->og_type ?? 'website') === 'website' ? 'selected' : '' }}>Website</option>
                            <option value="article" {{ old('og_type', $seo->og_type ?? 'website') === 'article' ? 'selected' : '' }}>Article</option>
                        </select>
                        @error('og_type')
                            <p class="form-error">{{ $message }}</p>
                        @enderror
                    </div>
                </div>
            </div>

            {{-- Twitter Card Tags --}}
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-lg font-semibold text-gray-900 mb-4">Twitter Card Tags</h2>
                
                <div class="space-y-4">
                    <div>
                        <label for="twitter_card" class="form-label">Twitter Card Type</label>
                        <select 
                            id="twitter_card" 
                            name="twitter_card" 
                            class="form-input @error('twitter_card') border-red-500 @enderror"
                        >
                            <option value="summary" {{ old('twitter_card', $seo->twitter_card ?? 'summary_large_image') === 'summary' ? 'selected' : '' }}>Summary</option>
                            <option value="summary_large_image" {{ old('twitter_card', $seo->twitter_card ?? 'summary_large_image') === 'summary_large_image' ? 'selected' : '' }}>Summary Large Image</option>
                        </select>
                        @error('twitter_card')
                            <p class="form-error">{{ $message }}</p>
                        @enderror
                    </div>

                    <div>
                        <label for="twitter_title" class="form-label">Twitter Title</label>
                        <input 
                            type="text" 
                            id="twitter_title" 
                            name="twitter_title" 
                            value="{{ old('twitter_title', $seo->og_title ?? $page->meta_title ?? $page->title) }}"
                            maxlength="255"
                            class="form-input @error('twitter_title') border-red-500 @enderror"
                        >
                        @error('twitter_title')
                            <p class="form-error">{{ $message }}</p>
                        @enderror
                    </div>

                    <div>
                        <label for="twitter_description" class="form-label">Twitter Description</label>
                        <textarea 
                            id="twitter_description" 
                            name="twitter_description" 
                            rows="3"
                            maxlength="500"
                            class="form-input @error('twitter_description') border-red-500 @enderror"
                        >{{ old('twitter_description', $seo->og_description ?? $page->meta_description) }}</textarea>
                        @error('twitter_description')
                            <p class="form-error">{{ $message }}</p>
                        @enderror
                    </div>

                    <div>
                        <label for="twitter_image" class="form-label">Twitter Image URL</label>
                        <input 
                            type="url" 
                            id="twitter_image" 
                            name="twitter_image" 
                            value="{{ old('twitter_image', $seo->og_image) }}"
                            class="form-input @error('twitter_image') border-red-500 @enderror"
                            placeholder="https://example.com/image.jpg"
                        >
                        <p class="mt-1 text-sm text-gray-500">Recommended: 1200x675px for large image</p>
                        @error('twitter_image')
                            <p class="form-error">{{ $message }}</p>
                        @enderror
                    </div>
                </div>
            </div>

            {{-- Current Meta Preview --}}
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-lg font-semibold text-gray-900 mb-4">Current Meta Preview</h2>
                <div class="bg-gray-50 p-4 rounded-lg space-y-2 text-sm">
                    <div><strong>Title:</strong> {{ $currentMeta['title'] ?? 'N/A' }}</div>
                    <div><strong>Description:</strong> {{ $currentMeta['description'] ?? 'N/A' }}</div>
                    <div><strong>Canonical:</strong> {{ $currentMeta['canonical'] ?? 'N/A' }}</div>
                </div>
            </div>
        </div>

        <div class="mt-6 flex items-center justify-end gap-3">
            <a href="{{ route('admin.pages.index') }}" class="btn btn-outline">
                Cancel
            </a>
            <button type="submit" class="btn btn-primary">
                Update SEO
            </button>
        </div>
    </form>
</div>

@push('scripts')
<script>
// Character counters with warnings
document.getElementById('meta_title').addEventListener('input', function() {
    const count = this.value.length;
    document.getElementById('titleCount').textContent = count;
    const warning = document.getElementById('titleWarning');
    if (count < 50 || count > 60) {
        warning.classList.remove('hidden');
    } else {
        warning.classList.add('hidden');
    }
});

document.getElementById('meta_description').addEventListener('input', function() {
    const count = this.value.length;
    document.getElementById('descCount').textContent = count;
    const warning = document.getElementById('descWarning');
    if (count < 150 || count > 160) {
        warning.classList.remove('hidden');
    } else {
        warning.classList.add('hidden');
    }
});
</script>
@endpush
@endsection
```

### 4.3 Validation
- Test SEO editor for pages
- Verify meta tags save correctly
- Check character count warnings
- Test form validation

## 5. Task P3.6.2: Implement Schema Markup Editor

### 5.1 Overview
Create an interface for editing and managing schema markup (JSON-LD) for pages.

### 5.2 Step-by-Step Implementation

#### Step 1: Add Schema Fields to PageSEO Model

Update the migration if needed to ensure `schema_markup` field exists as JSON.

#### Step 2: Create Schema Editor Component

**File: `resources/views/admin/seo/schema-editor.blade.php`** (partial)

```blade
<div class="bg-white rounded-lg shadow p-6">
    <h2 class="text-lg font-semibold text-gray-900 mb-4">Schema Markup (JSON-LD)</h2>
    
    <div class="space-y-4">
        <div>
            <label for="schema_type" class="form-label">Schema Type</label>
            <select id="schema_type" name="schema_type" class="form-input" onchange="updateSchemaType()">
                <option value="WebPage">WebPage</option>
                <option value="Article">Article</option>
                <option value="Organization">Organization</option>
                <option value="LocalBusiness">LocalBusiness</option>
                <option value="FAQPage">FAQPage</option>
            </select>
        </div>

        <div>
            <label for="schema_markup" class="form-label">Schema JSON</label>
            <textarea 
                id="schema_markup" 
                name="schema_markup" 
                rows="15"
                class="form-input font-mono text-sm @error('schema_markup') border-red-500 @enderror"
                placeholder='{"@context": "https://schema.org", "@type": "WebPage", ...}'
            >{{ old('schema_markup', $seo->schema_markup ? json_encode($seo->schema_markup, JSON_PRETTY_PRINT | JSON_UNESCAPED_SLASHES) : '') }}</textarea>
            <p class="mt-1 text-sm text-gray-500">Enter valid JSON-LD schema markup</p>
            @error('schema_markup')
                <p class="form-error">{{ $message }}</p>
            @enderror
        </div>

        <div>
            <button type="button" onclick="validateSchema()" class="btn btn-outline">
                Validate JSON
            </button>
            <button type="button" onclick="generateSchema()" class="btn btn-outline">
                Generate from Page Data
            </button>
        </div>
    </div>
</div>

@push('scripts')
<script>
function validateSchema() {
    const schemaText = document.getElementById('schema_markup').value;
    try {
        const schema = JSON.parse(schemaText);
        alert('Valid JSON!');
    } catch (e) {
        alert('Invalid JSON: ' + e.message);
    }
}

function generateSchema() {
    const type = document.getElementById('schema_type').value;
    const pageTitle = '{{ $page->title }}';
    const pageDescription = '{{ $page->meta_description ?? $page->excerpt }}';
    const pageUrl = '{{ url("/" . $page->slug) }}';

    const baseSchema = {
        "@context": "https://schema.org",
        "@type": type,
        "name": pageTitle,
        "description": pageDescription,
        "url": pageUrl,
    };

    if (type === 'Article') {
        baseSchema.datePublished = '{{ $page->created_at->toIso8601String() }}';
        baseSchema.dateModified = '{{ $page->updated_at->toIso8601String() }}';
    }

    document.getElementById('schema_markup').value = JSON.stringify(baseSchema, null, 2);
}

function updateSchemaType() {
    // Update schema type in JSON if editing
}
</script>
@endpush
```

#### Step 3: Add Schema Editor to Page SEO Form

Include the schema editor partial in the page SEO edit view.

### 5.3 Validation
- Test schema JSON validation
- Verify schema generation
- Test JSON parsing
- Check schema renders correctly

## 6. Task P3.6.3: Add Open Graph Tag Management

### 6.1 Overview
The Open Graph tag management is already included in the SEO editor (P3.6.1). This section ensures proper integration and preview.

### 6.2 Step-by-Step Implementation

#### Step 1: Add Open Graph Preview

Add a preview section to the SEO editor showing how the page will appear when shared on social media.

**File: `resources/views/admin/seo/edit-page.blade.php`** (add preview section)

```blade
{{-- Open Graph Preview --}}
<div class="bg-white rounded-lg shadow p-6">
    <h2 class="text-lg font-semibold text-gray-900 mb-4">Open Graph Preview</h2>
    <div class="border border-gray-200 rounded-lg p-4 max-w-md">
        <div id="ogPreview" class="space-y-2">
            <div class="text-xs text-gray-500">{{ config('app.url') }}</div>
            <div class="font-semibold text-lg" id="ogPreviewTitle">
                {{ old('og_title', $seo->og_title ?? $page->title) }}
            </div>
            <div class="text-sm text-gray-600" id="ogPreviewDesc">
                {{ old('og_description', $seo->og_description ?? $page->meta_description) }}
            </div>
            @if($seo->og_image ?? false)
            <img src="{{ $seo->og_image }}" alt="OG Image" class="w-full h-48 object-cover rounded mt-2">
            @endif
        </div>
    </div>
</div>
```

#### Step 2: Add Live Preview Updates

Add JavaScript to update preview as user types:

```javascript
document.getElementById('og_title').addEventListener('input', function() {
    document.getElementById('ogPreviewTitle').textContent = this.value || '{{ $page->title }}';
});

document.getElementById('og_description').addEventListener('input', function() {
    document.getElementById('ogPreviewDesc').textContent = this.value || '{{ $page->meta_description }}';
});
```

### 6.3 Validation
- Test Open Graph preview
- Verify tags save correctly
- Test social media sharing preview
- Check image URL validation

## 7. Task P3.6.4: Build Twitter Card Editor

### 7.1 Overview
The Twitter Card editor is already included in the SEO editor. This section adds preview functionality.

### 7.2 Step-by-Step Implementation

#### Step 1: Add Twitter Card Preview

Similar to Open Graph preview, add a Twitter Card preview section.

**File: `resources/views/admin/seo/edit-page.blade.php`** (add preview)

```blade
{{-- Twitter Card Preview --}}
<div class="bg-white rounded-lg shadow p-6">
    <h2 class="text-lg font-semibold text-gray-900 mb-4">Twitter Card Preview</h2>
    <div class="border border-gray-200 rounded-lg p-4 max-w-md bg-white">
        <div id="twitterPreview" class="space-y-2">
            @if(($seo->twitter_card ?? 'summary_large_image') === 'summary_large_image')
                @if($seo->og_image ?? false)
                <img src="{{ $seo->og_image }}" alt="Twitter Image" class="w-full h-48 object-cover rounded">
                @endif
            @endif
            <div class="text-xs text-gray-500">{{ config('app.url') }}</div>
            <div class="font-semibold text-base" id="twitterPreviewTitle">
                {{ old('twitter_title', $seo->og_title ?? $page->title) }}
            </div>
            <div class="text-sm text-gray-600" id="twitterPreviewDesc">
                {{ old('twitter_description', $seo->og_description ?? $page->meta_description) }}
            </div>
        </div>
    </div>
</div>
```

### 7.3 Validation
- Test Twitter Card preview
- Verify card type switching
- Test image display
- Check Twitter Card validator

## 8. Testing and Validation

### 8.1 Complete Workflow Test

1. **Edit Page SEO:**
   - Navigate to page SEO editor
   - Update meta tags
   - Set Open Graph tags
   - Configure Twitter Cards
   - Add schema markup
   - Save changes

2. **Preview SEO:**
   - Check meta tag previews
   - Verify Open Graph preview
   - Test Twitter Card preview
   - Validate schema JSON

3. **Test on Frontend:**
   - View page source
   - Verify meta tags are present
   - Check schema markup
   - Test social sharing

### 8.2 Common Issues and Solutions

#### Issue: Schema JSON invalid
**Solution:**
- Use JSON validator
- Check for trailing commas
- Verify proper escaping
- Test with schema.org validator

#### Issue: Open Graph image not showing
**Solution:**
- Verify image URL is absolute
- Check image dimensions (1200x630px)
- Test image accessibility
- Verify og:image tag

#### Issue: Meta tags not updating
**Solution:**
- Clear SEO cache
- Verify database updates
- Check SEOService cache
- Review model relationships

## 9. References

### 9.1 Architecture Documents
- SEO Architecture: `documentation/01-architecture/05-seo-architecture.md`
- Admin Panel Architecture: `documentation/01-architecture/09-admin-panel-architecture.md`

### 9.2 External Resources
- [Schema.org Documentation](https://schema.org/)
- [Open Graph Protocol](https://ogp.me/)
- [Twitter Cards](https://developer.twitter.com/en/docs/twitter-for-websites/cards/overview/abouts-cards)
- [Google Rich Results Test](https://search.google.com/test/rich-results)

### 9.3 Related Tasks
- **Previous Task**: P3.5 - Testimonial Management
- **Dependencies**: P2.1.4, P1.2.3, P3.1, P3.2

---

**Document Version**: 1.0  
**Last Updated**: 2025  
**Status**: Ready for Implementation
